# Codes for Figure 4 (Filament on a sphere)

This directory contains the codes to run the simulations for the flexible filament on a sphere (Figure 4).

* `FilamentOnSphere.morpho` is the main Morpho file that solves the optimization problem for a fixed value of $\Omega^{-1}$ (strength of bending relative to the gravity) and $\Phi$ (length of the filament in units of the radius of the substrate), the parameters defined in the text.

This file can be run using 
```bash
morpho5 FilamentOnSphere.morpho
```
in which case, it will use the default values $\Omega^{-1}=0.1$ and $\Phi = 5$. You can change these paramteres by modifying lines 27-28 in the code.

This will generate four files:
1. `curvature.vtk`, which stores the configuration in the VTK format, and
2. `curvature.txt` storing the local curvature as a function of arclength in a text file. We will use this file to plot the curvature using Python.
3. `final.png` is a POVRay-rendered image of the final configuration.
4. `final.pov` is the POVRay file that can be re-used to render the image. 

> Note: You can change the name of these files by modifying the last line of `FilamentOnSphere.morpho`

* `plotcurvature.py` is the Python script that can be used to plot the curvature data generated by the file above. It will generate a file `curvature.pdf` with the graphic. Both input and output filenames can be changed inside the file.

* `sortMesh.morpho` provides a simple function that takes in a line mesh and returns the list of vertex indices in the order in which they are connected. This is useful to export the curvature vs arclength data. (This function is needed since we are using refinement. If we don't refine, the vertices are already ordered according to the arclength when generated using `LineMesh`.)